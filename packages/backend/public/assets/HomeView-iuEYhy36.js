import{a as w,E as F}from"./EventCard-5brpXagm.js";import{q as v,o as a,c as u,a as e,t as m,i as E,s as h,v as y,f as N,e as $,F as q,x as A,y as L,b as C,g as M,u as U,j as I}from"./vendor-D2h_NbJw.js";import{_ as T,u as K,a as O}from"./index-BWLtSEKQ.js";const j={class:"modal-dialog"},H={class:"modal-content"},R={class:"modal-header"},z={class:"modal-title"},J={class:"modal-body"},W={class:"event-details"},G={class:"detail-grid"},P={class:"detail-item"},Q={class:"detail-item"},X={class:"detail-item"},Y={class:"detail-item"},Z={class:"detail-location mt-2"},ee={class:"detail-item"},te={class:"detail-item"},se={class:"row"},oe={class:"col-md-6"},le={class:"form-group"},ie=["disabled"],ne={class:"col-md-6"},ae={class:"form-group"},re=["disabled"],de={class:"row"},ue={class:"col-md-6"},me={class:"form-group"},ce=["disabled"],ve={class:"col-md-6"},be={class:"form-group"},pe=["disabled"],ge={class:"form-group"},fe=["disabled"],he={class:"modal-footer"},ye={class:"d-flex gap-3 w-100 justify-content-end"},ke=["disabled"],_e=["disabled"],we={key:0,class:"spinner-border spinner-border-sm me-2",role:"status"},Ne={key:1,class:"bi bi-check-lg me-1"},Te={__name:"BookingDialog",props:{appointment:{type:Object,required:!0},loading:{type:Boolean,default:!1}},emits:["close","submit"],setup(o,{emit:r}){const k=r,s=v({firstName:"",lastName:"",email:"",phone:"",notes:""}),c=()=>{!s.value.firstName||!s.value.lastName||!s.value.email||k("submit",{firstName:s.value.firstName,lastName:s.value.lastName,email:s.value.email,phone:s.value.phone||null,notes:s.value.notes||null})},b=d=>new Date(d).toLocaleDateString("de-DE",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),p=d=>new Date(d).toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit"});return(d,t)=>(a(),u("div",null,[t[19]||(t[19]=e("div",{class:"modal-backdrop"},null,-1)),e("div",j,[e("div",H,[e("div",R,[e("h5",z,m(o.appointment.title),1)]),e("div",J,[e("div",W,[e("div",G,[e("div",P,[t[6]||(t[6]=e("i",{class:"bi bi-calendar me-2"},null,-1)),e("span",null,m(b(o.appointment.date)),1)]),e("div",Q,[t[7]||(t[7]=e("i",{class:"bi bi-clock me-2"},null,-1)),e("span",null,m(p(o.appointment.startTime)),1)]),e("div",X,[t[8]||(t[8]=e("i",{class:"bi bi-hourglass me-2"},null,-1)),e("span",null,m(o.appointment.duration)+" Min.",1)]),e("div",Y,[t[9]||(t[9]=e("i",{class:"bi bi-currency-euro me-2"},null,-1)),e("span",null,m(o.appointment.price)+"€",1)])]),e("div",Z,[e("div",ee,[t[10]||(t[10]=e("i",{class:"bi bi-geo-alt me-2"},null,-1)),e("span",null,m(o.appointment.location||"Kein Ort"),1)]),e("div",te,[t[11]||(t[11]=e("i",{class:"bi bi-door-closed me-2"},null,-1)),e("span",null,m(o.appointment.room||"Kein Raum"),1)])])]),e("form",{onSubmit:E(c,["prevent"]),class:"booking-form"},[e("div",se,[e("div",oe,[e("div",le,[t[12]||(t[12]=e("label",{class:"form-label required"},"Vorname",-1)),h(e("input",{"onUpdate:modelValue":t[0]||(t[0]=i=>s.value.firstName=i),type:"text",class:"form-control",required:"",placeholder:"Ihr Vorname",disabled:o.loading},null,8,ie),[[y,s.value.firstName]])])]),e("div",ne,[e("div",ae,[t[13]||(t[13]=e("label",{class:"form-label required"},"Nachname",-1)),h(e("input",{"onUpdate:modelValue":t[1]||(t[1]=i=>s.value.lastName=i),type:"text",class:"form-control",required:"",placeholder:"Ihr Nachname",disabled:o.loading},null,8,re),[[y,s.value.lastName]])])])]),e("div",de,[e("div",ue,[e("div",me,[t[14]||(t[14]=e("label",{class:"form-label required"},"E-Mail",-1)),h(e("input",{"onUpdate:modelValue":t[2]||(t[2]=i=>s.value.email=i),type:"email",class:"form-control",required:"",placeholder:"ihre@email.de",disabled:o.loading},null,8,ce),[[y,s.value.email]])])]),e("div",ve,[e("div",be,[t[15]||(t[15]=e("label",{class:"form-label"},"Telefon",-1)),h(e("input",{"onUpdate:modelValue":t[3]||(t[3]=i=>s.value.phone=i),type:"tel",class:"form-control",placeholder:"Optional",disabled:o.loading},null,8,pe),[[y,s.value.phone]])])])]),e("div",ge,[t[16]||(t[16]=e("label",{class:"form-label"},"Anmerkungen",-1)),h(e("textarea",{"onUpdate:modelValue":t[4]||(t[4]=i=>s.value.notes=i),class:"form-control",rows:"3",placeholder:"Optional",disabled:o.loading},null,8,fe),[[y,s.value.notes]])])],32)]),e("div",he,[e("div",ye,[e("button",{type:"button",class:"btn btn-light",onClick:t[5]||(t[5]=i=>d.$emit("close")),disabled:o.loading},t[17]||(t[17]=[e("i",{class:"bi bi-x-lg me-1"},null,-1),N("Abbrechen ")]),8,ke),e("button",{type:"button",class:"btn btn-primary",onClick:c,disabled:o.loading},[o.loading?(a(),u("div",we,t[18]||(t[18]=[e("span",{class:"visually-hidden"},"Loading...",-1)]))):(a(),u("i",Ne)),N(" "+m(o.loading?"Wird gebucht...":"Jetzt buchen"),1)],8,_e)])])])])]))}},xe=T(Te,[["__scopeId","data-v-92b28e92"]]),Be={class:"container-fluid py-3"},De={key:0,class:"text-center py-4"},Se={key:1,class:"alert alert-danger",role:"alert"},Ve={key:2,class:"text-center py-4"},Fe={key:3,class:"row row-cols-1 row-cols-sm-2 row-cols-lg-3 row-cols-xl-4 g-3"},Ee={__name:"HomeView",setup(o){const r=K(),k=O(),s=I(),c=v([]),b=v(null),p=v(!1),d=v(!1),t=v(!1),i=v(null),_=async()=>{d.value=!0,i.value=null;try{const n=await w.getEvents();c.value=Array.isArray(n)?n:[]}catch(n){console.error("Failed to fetch appointments:",n),i.value="Fehler beim Laden der Termine. Bitte versuchen Sie es später erneut.",c.value=[]}finally{d.value=!1}},x=n=>{b.value=n,p.value=!0},B=async n=>{try{s.push("/admin")}catch(l){console.error("Failed to handle edit:",l),r.error("Fehler beim Bearbeiten des Termins")}},D=async n=>{try{s.push("/admin")}catch(l){console.error("Failed to handle copy:",l),r.error("Fehler beim Kopieren des Termins")}},S=async n=>{try{if(!confirm("Möchten Sie diesen Termin wirklich löschen?"))return;await w.deleteEvent(n.id),r.success("Termin erfolgreich gelöscht"),await _()}catch(l){console.error("Failed to delete event:",l),r.error("Fehler beim Löschen des Termins")}},V=async n=>{var l,g;if(!t.value){t.value=!0;try{console.log("Submitting booking:",{id:b.value.id,bookingData:n});const f=await w.bookEvent(b.value.id,n);console.log("Booking response:",f),r.success("Termin erfolgreich gebucht"),p.value=!1,await _()}catch(f){console.error("Failed to book appointment:",f),(l=f.message)!=null&&l.includes("fully booked")?r.error("Dieser Termin ist leider bereits ausgebucht"):(g=f.message)!=null&&g.includes("not available")?r.error("Dieser Termin ist nicht mehr verfügbar"):r.error("Fehler beim Buchen des Termins. Bitte versuchen Sie es später erneut.")}finally{t.value=!1}}};return $(()=>{_()}),(n,l)=>(a(),u("div",Be,[l[3]||(l[3]=e("h1",{class:"h3 mb-4"},"Verfügbare Termine",-1)),d.value?(a(),u("div",De,l[1]||(l[1]=[e("div",{class:"spinner-border text-primary",role:"status"},[e("span",{class:"visually-hidden"},"Loading...")],-1)]))):i.value?(a(),u("div",Se,m(i.value),1)):c.value.length?(a(),u("div",Fe,[(a(!0),u(q,null,A(c.value,g=>(a(),u("div",{key:g.id,class:"col"},[M(F,{event:g,loading:d.value,"is-admin":U(k).isAuthenticated,onBook:x,onEdit:B,onCopy:D,onDelete:S},null,8,["event","loading","is-admin"])]))),128))])):(a(),u("div",Ve,l[2]||(l[2]=[e("p",{class:"text-muted mb-0"},"Keine Termine verfügbar",-1)]))),p.value?(a(),L(xe,{key:4,appointment:b.value,loading:t.value,onClose:l[0]||(l[0]=g=>p.value=!1),onSubmit:V},null,8,["appointment","loading"])):C("",!0)]))}},Le=T(Ee,[["__scopeId","data-v-9a796e3d"]]);export{Le as default};
