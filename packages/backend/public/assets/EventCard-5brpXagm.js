import{a as E,_ as k,u as S}from"./index-BWLtSEKQ.js";import{q as $,o as r,c as u,a as e,t as l,F as B,x as q,f as c,B as f,n as A,b as y,y as w}from"./vendor-D2h_NbJw.js";const x="http://localhost:3000/api";class p{constructor(){this.authStore=E()}async request(i,o={}){const m=`${x}${i}`,v=o.requiresAuth?this.authStore.getAuthHeader():{};console.log("Auth header for request:",v);const b={"Content-Type":"application/json",...v,...o.headers};try{const h=o.body?JSON.parse(o.body):void 0;console.log("API Request Details:",{url:m,method:o.method||"GET",headers:b,body:h});const a=await fetch(m,{method:o.method||"GET",headers:b,body:o.body});if(!a.ok)throw new Error(`Server returned ${a.status}: ${a.statusText}`);const s=a.headers.get("content-type");if(s&&s.includes("application/json")){const t=await a.json();return console.log("API Response:",{status:a.status,statusText:a.statusText,headers:Object.fromEntries(a.headers.entries()),data:t}),t}return null}catch(h){throw console.error(`API Error (${i}):`,h),h}}async login(i){return this.request("/auth/login",{method:"POST",body:JSON.stringify(i)})}async getEvents(i=!1){const o=this.authStore.getAuthHeader();return console.log("Getting events with auth:",o),this.request("/dates",{requiresAuth:!0,headers:{...o}})}async createEvent(i){return console.log("Creating event with data:",i),this.request("/dates",{method:"POST",body:JSON.stringify(i),requiresAuth:!0})}async updateEvent(i,o){return this.request(`/dates/${i}`,{method:"PUT",body:JSON.stringify(o),requiresAuth:!0})}async deleteEvent(i){return this.request(`/dates/${i}`,{method:"DELETE",requiresAuth:!0})}async bookEvent(i,o){return this.request(`/dates/${i}/book`,{method:"POST",body:JSON.stringify(o)})}async getEventBookings(i){return this.request(`/dates/${i}/bookings`,{requiresAuth:!0})}async deleteBooking(i,o){return this.request(`/dates/${i}/bookings/${o}`,{method:"DELETE",requiresAuth:!0})}}const T=new p,C={class:"modal fade show",style:{display:"block"},tabindex:"-1"},D={class:"modal-dialog modal-dialog-centered modal-lg"},N={class:"modal-content"},O={class:"modal-header"},L={class:"modal-title"},j={class:"modal-body"},P={key:0,class:"bookings-list"},I={class:"d-flex justify-content-between align-items-start"},J={class:"h6 mb-1"},F={class:"text-muted"},H={class:"d-flex flex-column align-items-end"},K={class:"text-muted mb-2"},M=["disabled","onClick"],R={key:1,class:"text-center py-4 text-muted"},V={class:"modal-footer"},z={__name:"BookingsModal",props:{event:{type:Object,required:!0}},emits:["close","booking-deleted"],setup(n,{emit:i}){const o=n,m=i,v=S(),b=$(!1),h=async a=>{if(confirm(`Möchten Sie die Buchung von ${a.firstName} ${a.lastName} wirklich löschen?`)){b.value=!0;try{await T.deleteBooking(o.event.id,a.id),v.success("Buchung erfolgreich gelöscht"),m("booking-deleted")}catch(s){console.error("Failed to delete booking:",s),v.error("Fehler beim Löschen der Buchung")}finally{b.value=!1}}};return(a,s)=>{var t;return r(),u("div",C,[e("div",D,[e("div",N,[e("div",O,[e("h5",L," Buchungen für "+l(n.event.title),1),e("button",{type:"button",class:"btn-close",onClick:s[0]||(s[0]=d=>a.$emit("close"))})]),e("div",j,[(t=n.event.bookings)!=null&&t.length?(r(),u("div",P,[(r(!0),u(B,null,q(n.event.bookings,d=>(r(),u("div",{key:d.id,class:"booking-item mb-2 p-3 bg-light rounded"},[e("div",I,[e("div",null,[e("div",J,l(d.firstName)+" "+l(d.lastName),1),e("div",F,[e("div",null,[s[2]||(s[2]=e("i",{class:"bi bi-envelope me-2"},null,-1)),c(l(d.email),1)]),e("div",null,[s[3]||(s[3]=e("i",{class:"bi bi-telephone me-2"},null,-1)),c(l(d.phone||"Keine Telefonnummer"),1)])])]),e("div",H,[e("div",K,[s[4]||(s[4]=e("i",{class:"bi bi-calendar me-1"},null,-1)),c(" "+l(new Date(d.createdAt).toLocaleDateString("de-DE")),1)]),e("button",{class:"btn btn-danger btn-sm",disabled:b.value,onClick:g=>h(d)},s[5]||(s[5]=[e("i",{class:"bi bi-trash me-1"},null,-1),c(" Löschen ")]),8,M)])])]))),128))])):(r(),u("div",R,s[6]||(s[6]=[e("i",{class:"bi bi-calendar-x display-4 d-block mb-3"},null,-1),c(" Keine Buchungen vorhanden ")])))]),e("div",V,[e("button",{type:"button",class:"btn btn-secondary",onClick:s[1]||(s[1]=d=>a.$emit("close"))}," Schließen ")])])]),s[7]||(s[7]=e("div",{class:"modal-backdrop fade show"},null,-1))])}}},G=k(z,[["__scopeId","data-v-67b6ec0c"]]),U={class:"card h-100"},Q={class:"card-body p-3"},W={class:"d-flex justify-content-between align-items-start mb-2"},X={class:"card-title mb-0"},Y={class:"mb-2"},Z={class:"detail-item"},_={class:"detail-item"},ee={class:"detail-item"},te={class:"detail-item"},se={class:"detail-item"},ne={class:"detail-item"},ie={key:0,class:"mt-2 border-top pt-2"},oe={class:"card-actions mt-2 pt-2 border-top"},le=["disabled"],ae=["disabled"],de=["disabled"],re=["disabled"],ue={__name:"EventCard",props:{event:{type:Object,required:!0},loading:{type:Boolean,default:!1},isAdmin:{type:Boolean,default:!1}},emits:["edit","copy","delete","book","refresh"],setup(n,{emit:i}){const o=n,m=$(!1),v=f(()=>{var s;return((s=o.event.bookings)==null?void 0:s.length)||0}),b=f(()=>v.value>=o.event.maxBookings),h=s=>s?new Date(s).toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric"}):"",a=s=>s?new Date(s).toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit",hour12:!1})+" Uhr":"";return(s,t)=>{var d;return r(),u("div",U,[e("div",Q,[e("div",W,[e("h6",X,l(n.event.title),1),n.isAdmin?(r(),u("span",{key:0,class:A(["badge",n.event.visibility?"bg-success":"bg-warning"])},l(n.event.visibility?"Sichtbar":"Versteckt"),3)):y("",!0)]),e("div",Y,[e("div",Z,[t[7]||(t[7]=e("i",{class:"bi bi-calendar text-primary"},null,-1)),e("span",null,l(h(n.event.date)),1)]),e("div",_,[t[8]||(t[8]=e("i",{class:"bi bi-clock text-primary"},null,-1)),e("span",null,l(a(n.event.startTime))+" ("+l(n.event.duration)+" Min.)",1)]),e("div",ee,[t[9]||(t[9]=e("i",{class:"bi bi-geo-alt text-primary"},null,-1)),e("span",null,l(n.event.location||"Kein Ort"),1)]),e("div",te,[t[10]||(t[10]=e("i",{class:"bi bi-door-closed text-primary"},null,-1)),e("span",null,l(n.event.room||"Kein Raum"),1)]),e("div",se,[t[11]||(t[11]=e("i",{class:"bi bi-people text-primary"},null,-1)),e("span",null,l(v.value)+" / "+l(n.event.maxBookings),1)]),e("div",ne,[t[12]||(t[12]=e("i",{class:"bi bi-currency-euro text-primary"},null,-1)),e("span",null,l(n.event.price)+"€",1)])]),n.isAdmin?(r(),u("div",ie,[e("button",{class:"btn btn-outline-primary btn-sm w-100",onClick:t[0]||(t[0]=g=>m.value=!0)},[t[13]||(t[13]=e("i",{class:"bi bi-person-lines-fill me-1"},null,-1)),c(" Buchungen anzeigen ("+l(((d=n.event.bookings)==null?void 0:d.length)||0)+") ",1)])])):y("",!0),e("div",oe,[n.isAdmin?(r(),u(B,{key:0},[e("button",{class:"btn btn-primary btn-sm",onClick:t[1]||(t[1]=g=>s.$emit("edit",n.event)),disabled:n.loading},t[14]||(t[14]=[e("i",{class:"bi bi-pencil"},null,-1),c(" Bearbeiten ")]),8,le),e("button",{class:"btn btn-info btn-sm",onClick:t[2]||(t[2]=g=>s.$emit("copy",n.event)),disabled:n.loading},t[15]||(t[15]=[e("i",{class:"bi bi-files"},null,-1),c(" Kopieren ")]),8,ae),e("button",{class:"btn btn-danger btn-sm",onClick:t[3]||(t[3]=g=>s.$emit("delete",n.event)),disabled:n.loading},t[16]||(t[16]=[e("i",{class:"bi bi-trash"},null,-1),c(" Löschen ")]),8,de)],64)):(r(),u("button",{key:1,class:"btn btn-primary btn-sm",onClick:t[4]||(t[4]=g=>s.$emit("book",n.event)),disabled:n.loading||b.value},[t[17]||(t[17]=e("i",{class:"bi bi-calendar-check"},null,-1)),c(" "+l(b.value?"Ausgebucht":"Jetzt buchen"),1)],8,re))])]),m.value?(r(),w(G,{key:0,event:n.event,onClose:t[5]||(t[5]=g=>m.value=!1),onBookingDeleted:t[6]||(t[6]=g=>s.$emit("refresh"))},null,8,["event"])):y("",!0)])}}},me=k(ue,[["__scopeId","data-v-f0419e8e"]]);export{me as E,T as a};
